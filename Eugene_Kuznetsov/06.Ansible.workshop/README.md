#### 06. Ansible workshop
### Homework Assignment 1: Configuration Management

```bash
eugene@MBA 06.Ansible.workshop % ansible-playbook -i inv.yaml nginx.yaml -e '{"s_name":[site_1,site_2]}' -u root

PLAY [nginx] ***********************************************************************************************************************************************************************************************

TASK [Gathering Facts] *************************************************************************************************************************************************************************************
Tuesday 08 October 2024  18:07:06 +0300 (0:00:00.046)       0:00:00.046 ******* 
ok: [nginx]

TASK [Validate] ********************************************************************************************************************************************************************************************
Tuesday 08 October 2024  18:07:18 +0300 (0:00:12.782)       0:00:12.828 ******* 
ok: [nginx] => (item=site_1) => {
    "msg": [
        "Virtual server: site_1",
        "Root: /var/www/site_1"
    ]
}
ok: [nginx] => (item=site_2) => {
    "msg": [
        "Virtual server: site_2",
        "Root: /var/www/site_2"
    ]
}

TASK [Update apt package index] ****************************************************************************************************************************************************************************
Tuesday 08 October 2024  18:07:18 +0300 (0:00:00.080)       0:00:12.908 ******* 
ok: [nginx]

TASK [Install Nginx] ***************************************************************************************************************************************************************************************
Tuesday 08 October 2024  18:07:27 +0300 (0:00:08.796)       0:00:21.704 ******* 
ok: [nginx]

TASK [Add hosts] *******************************************************************************************************************************************************************************************
Tuesday 08 October 2024  18:07:34 +0300 (0:00:07.024)       0:00:28.729 ******* 
changed: [nginx] => (item=site_1)
changed: [nginx] => (item=site_2)

TASK [Create document roots for virtual hosts] *************************************************************************************************************************************************************
Tuesday 08 October 2024  18:07:47 +0300 (0:00:12.492)       0:00:41.221 ******* 
changed: [nginx] => (item=site_1)
changed: [nginx] => (item=site_2)

TASK [Create virtual host configuration files] *************************************************************************************************************************************************************
Tuesday 08 October 2024  18:08:00 +0300 (0:00:13.629)       0:00:54.851 ******* 
changed: [nginx] => (item=site_1)
changed: [nginx] => (item=site_2)

TASK [Enable virtual host configuration] *******************************************************************************************************************************************************************
Tuesday 08 October 2024  18:08:32 +0300 (0:00:31.111)       0:01:25.963 ******* 
changed: [nginx] => (item=site_1)
changed: [nginx] => (item=site_2)

TASK [Remove default Nginx configuration] ******************************************************************************************************************************************************************
Tuesday 08 October 2024  18:08:44 +0300 (0:00:12.482)       0:01:38.445 ******* 
ok: [nginx]

TASK [Test Nginx configuration] ****************************************************************************************************************************************************************************
Tuesday 08 October 2024  18:08:51 +0300 (0:00:06.845)       0:01:45.290 ******* 
changed: [nginx]

TASK [Fail if Nginx configuration is invalid] **************************************************************************************************************************************************************
Tuesday 08 October 2024  18:08:58 +0300 (0:00:07.508)       0:01:52.799 ******* 
skipping: [nginx]

TASK [Create HTML page] ************************************************************************************************************************************************************************************
Tuesday 08 October 2024  18:08:58 +0300 (0:00:00.040)       0:01:52.839 ******* 
changed: [nginx] => (item=site_1)
changed: [nginx] => (item=site_2)

TASK [Reload Nginx] ****************************************************************************************************************************************************************************************
Tuesday 08 October 2024  18:09:30 +0300 (0:00:31.441)       0:02:24.281 ******* 
changed: [nginx]

TASK [Check that a page returns successfully but fail if the word 'prod' is not in the page contents] ******************************************************************************************************
Tuesday 08 October 2024  18:09:37 +0300 (0:00:07.357)       0:02:31.638 ******* 
failed: [nginx] (item=site_1) => {"accept_ranges": "bytes", "ansible_loop_var": "item", "changed": false, "connection": "close", "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <title>Results</title>\n</head>\n\n<body>\n  <h1>This is page for site_1 site.</h1>\n</body>\n</html>\n\n", "content_length": "164", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 08 Oct 2024 15:09:46 GMT", "elapsed": 0, "etag": "\"67054b12-a4\"", "failed_when_result": true, "item": "site_1", "last_modified": "Tue, 08 Oct 2024 15:09:06 GMT", "msg": "OK (164 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://site_1.local"}
failed: [nginx] (item=site_2) => {"accept_ranges": "bytes", "ansible_loop_var": "item", "changed": false, "connection": "close", "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <title>Results</title>\n</head>\n\n<body>\n  <h1>This is page for site_2 site.</h1>\n</body>\n</html>\n\n", "content_length": "164", "content_type": "text/html", "cookies": {}, "cookies_string": "", "date": "Tue, 08 Oct 2024 15:09:53 GMT", "elapsed": 0, "etag": "\"67054b23-a4\"", "failed_when_result": true, "item": "site_2", "last_modified": "Tue, 08 Oct 2024 15:09:23 GMT", "msg": "OK (164 bytes)", "redirected": false, "server": "nginx/1.18.0 (Ubuntu)", "status": 200, "url": "http://site_2.local"}

PLAY RECAP *************************************************************************************************************************************************************************************************
nginx                      : ok=12   changed=7    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   

Tuesday 08 October 2024  18:09:54 +0300 (0:00:17.009)       0:02:48.648 ******* 
=============================================================================== 
Create HTML page ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 31.44s
Create virtual host configuration files ------------------------------------------------------------------------------------------------------------------------------------------------------------ 31.11s
Check that a page returns successfully but fail if the word 'prod' is not in the page contents ----------------------------------------------------------------------------------------------------- 17.01s
Create document roots for virtual hosts ------------------------------------------------------------------------------------------------------------------------------------------------------------ 13.63s
Gathering Facts ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ 12.78s
Add hosts ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ 12.49s
Enable virtual host configuration ------------------------------------------------------------------------------------------------------------------------------------------------------------------ 12.48s
Update apt package index ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 8.80s
Test Nginx configuration ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 7.51s
Reload Nginx ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 7.36s
Install Nginx --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 7.02s
Remove default Nginx configuration ------------------------------------------------------------------------------------------------------------------------------------------------------------------ 6.85s
Validate -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.08s
Fail if Nginx configuration is invalid -------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.04s
Playbook run took 0 days, 0 hours, 2 minutes, 48 seconds


```

---
- hosts: redmine
  gather_facts: no
  become: true
  pre_tasks:
    - name: check host
      shell: | 
        hostname
      register: out
    - name: Show host
      debug:
        msg: "{{ out.stdout }}"

  roles:
    - mysql
    - redmine
    
  # tasks:
  #   - name: "Add {{ app_fqdn }} to host file"
  #     shell: echo "127.0.0.1       {{ app_fqdn }}" >> /etc/hosts
  #   - uri:
  #       url: "http://{{ app_fqdn }}"
  #       return_content: yes
  #     register: this
  #     failed_when: "'Jean-Philippe Lang' not in this.content"
  #   - lineinfile:
  #       path: /etc/hosts
  #       state: absent
  #       regexp: '^127.0.0.1       {{ app_fqdn }}'

  # 13. Ansible cruise
  ---
  ### Create Ansible Playbook with role(s) to install Nginx server and setup two virtual hosts. + Implement testing role
```
apachy@apachy-server:~/ansible$ ansible-playbook web.yaml -i hosts.yaml -u root --ask-vault-pass
Vault password:

PLAY [ec_all] **************************************************************************************************************************************

TASK [Gathering Facts] *****************************************************************************************************************************
Thursday 08 April 2021  06:46:10 +0000 (0:00:00.095)       0:00:00.095 ********
ok: [centos]
ok: [ubuntu]

TASK [webserver : Nginx-Debian. Install packages] **************************************************************************************************
Thursday 08 April 2021  06:46:13 +0000 (0:00:03.408)       0:00:03.504 ********
skipping: [centos]
ok: [ubuntu]

TASK [webserver : Nginx. Enable and start servce] **************************************************************************************************
Thursday 08 April 2021  06:46:24 +0000 (0:00:10.355)       0:00:13.860 ********
skipping: [centos]
ok: [ubuntu]

TASK [webserver : Remove Index File Ubuntu] ********************************************************************************************************
Thursday 08 April 2021  06:46:26 +0000 (0:00:01.987)       0:00:15.847 ********
skipping: [centos]
changed: [ubuntu]

TASK [webserver : Copy Home Page Ubuntu] ***********************************************************************************************************
Thursday 08 April 2021  06:46:27 +0000 (0:00:01.371)       0:00:17.219 ********
skipping: [centos]
changed: [ubuntu]

TASK [webserver : Add epel-release repo] ***********************************************************************************************************
Thursday 08 April 2021  06:46:30 +0000 (0:00:02.803)       0:00:20.022 ********
skipping: [ubuntu]
ok: [centos]

TASK [webserver : Nginx-RedHat. Install packages] **************************************************************************************************
Thursday 08 April 2021  06:46:32 +0000 (0:00:01.668)       0:00:21.691 ********
skipping: [ubuntu]
ok: [centos]

TASK [webserver : Nginx. Enable and start servce] **************************************************************************************************
Thursday 08 April 2021  06:46:33 +0000 (0:00:01.257)       0:00:22.948 ********
skipping: [ubuntu]
ok: [centos]

TASK [webserver : Remove Index File CentOS] ********************************************************************************************************
Thursday 08 April 2021  06:46:34 +0000 (0:00:01.237)       0:00:24.186 ********
skipping: [ubuntu]
changed: [centos]

TASK [webserver : Copy Home Page CentOS] ***********************************************************************************************************
Thursday 08 April 2021  06:46:35 +0000 (0:00:01.209)       0:00:25.396 ********
skipping: [ubuntu]
changed: [centos]

TASK [webserver : CentOS. Enable firewall port] ****************************************************************************************************
Thursday 08 April 2021  06:46:37 +0000 (0:00:02.067)       0:00:27.463 ********
skipping: [ubuntu]
ok: [centos]

TASK [webserver : reload service firewalld] ********************************************************************************************************
Thursday 08 April 2021  06:46:39 +0000 (0:00:01.607)       0:00:29.070 ********
skipping: [ubuntu]
changed: [centos]

TASK [webserver : Check connection to Localhost] ***************************************************************************************************
Thursday 08 April 2021  06:46:41 +0000 (0:00:01.735)       0:00:30.806 ********
ok: [centos]
ok: [ubuntu]

TASK [webserver : print out] ***********************************************************************************************************************
Thursday 08 April 2021  06:46:42 +0000 (0:00:01.271)       0:00:32.078 ********
ok: [centos] => {
    "msg": {
        "changed": false,
        "elapsed": 0,
        "failed": false,
        "match_groupdict": {},
        "match_groups": [],
        "path": null,
        "port": 80,
        "search_regex": null,
        "state": "started"
    }
}
ok: [ubuntu] => {
    "msg": {
        "changed": false,
        "elapsed": 0,
        "failed": false,
        "match_groupdict": {},
        "match_groups": [],
        "path": null,
        "port": 80,
        "search_regex": null,
        "state": "started"
    }
}

TASK [webserver : Templates] ***********************************************************************************************************************
Thursday 08 April 2021  06:46:42 +0000 (0:00:00.240)       0:00:32.318 ********
ok: [centos]
ok: [ubuntu]

TASK [webserver : Check template] ******************************************************************************************************************
Thursday 08 April 2021  06:46:44 +0000 (0:00:01.848)       0:00:34.167 ********
ok: [ubuntu]
ok: [centos]

TASK [webserver : print out] ***********************************************************************************************************************
Thursday 08 April 2021  06:46:45 +0000 (0:00:01.162)       0:00:35.330 ********
ok: [centos] => {
    "msg": [
        "### Ansible managed",
        "",
        "127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4",
        "::1         localhost localhost.localdomain localhost6 localhost6.localdomain6",
        "",
        "192.168.202.5   local-centos.site",
        "192.168.202.6   local-ubuntu.site"
    ]
}
ok: [ubuntu] => {
    "msg": [
        "### Ansible managed",
        "",
        "127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4",
        "::1         localhost localhost.localdomain localhost6 localhost6.localdomain6",
        "",
        "192.168.202.5   local-centos.site",
        "192.168.202.6   local-ubuntu.site"
    ]
}

TASK [webserver : Check content to the sites] ******************************************************************************************************
Thursday 08 April 2021  06:46:46 +0000 (0:00:00.272)       0:00:35.602 ********
ok: [centos] => (item={'name': 'local-centos.site', 'ip': '192.168.202.5'})
ok: [ubuntu] => (item={'name': 'local-centos.site', 'ip': '192.168.202.5'})
ok: [centos] => (item={'name': 'local-ubuntu.site', 'ip': '192.168.202.6'})
ok: [ubuntu] => (item={'name': 'local-ubuntu.site', 'ip': '192.168.202.6'})

TASK [webserver : print out] ***********************************************************************************************************************
Thursday 08 April 2021  06:46:48 +0000 (0:00:02.659)       0:00:38.262 ********
ok: [centos] => {
    "msg": "<!DOCTYPE HTML>\n<html>\n\t<head>\n\t\t   <meta charset=\"utf-8\">\n\t\t      <title>Home Page</title>\n\t</head>\n\t<body>\n\t\t<h1>Hi!</h1>\n\t\t              <a href=\"http://sonarr:8989\"><button><h3>SONARR</h3></button></a>\n\t\t\t                    <a href=\"http://radarr:7878\"><button><h3>RADARR</h3></button></a>\n\n\t</body>\n</html>\n | <!DOCTYPE HTML>\n<html>\n\t<head>\n\t\t   <meta charset=\"utf-8\">\n\t\t      <title>Home Page</title>\n\t</head>\n\t<body>\n\t\t<h1>Hi!</h1>\n\t\t              <a href=\"http://sonarr:8989\"><button><h3>SONARR</h3></button></a>\n\t\t\t                    <a href=\"http://radarr:7878\"><button><h3>RADARR</h3></button></a>\n\n\t</body>\n</html>\n"
}
ok: [ubuntu] => {
    "msg": "<!DOCTYPE HTML>\n<html>\n\t<head>\n\t\t   <meta charset=\"utf-8\">\n\t\t      <title>Home Page</title>\n\t</head>\n\t<body>\n\t\t<h1>Hi!</h1>\n\t\t              <a href=\"http://sonarr:8989\"><button><h3>SONARR</h3></button></a>\n\t\t\t                    <a href=\"http://radarr:7878\"><button><h3>RADARR</h3></button></a>\n\n\t</body>\n</html>\n | <!DOCTYPE HTML>\n<html>\n\t<head>\n\t\t   <meta charset=\"utf-8\">\n\t\t      <title>Home Page</title>\n\t</head>\n\t<body>\n\t\t<h1>Hi!</h1>\n\t\t              <a href=\"http://sonarr:8989\"><button><h3>SONARR</h3></button></a>\n\t\t\t                    <a href=\"http://radarr:7878\"><button><h3>RADARR</h3></button></a>\n\n\t</body>\n</html>\n"
}

TASK [check : Check SUDO with NOPASSWD] ************************************************************************************************************
Thursday 08 April 2021  06:46:48 +0000 (0:00:00.256)       0:00:38.518 ********
ok: [centos]
ok: [ubuntu]

TASK [check : Check public repositories] ***********************************************************************************************************
Thursday 08 April 2021  06:46:50 +0000 (0:00:01.073)       0:00:39.592 ********
ok: [centos] => (item={'url': 'ftp.by.debian.org', 'port': 80})
ok: [ubuntu] => (item={'url': 'ftp.by.debian.org', 'port': 80})
ok: [centos] => (item={'url': 'ftp.byfly.by', 'port': 80})
ok: [ubuntu] => (item={'url': 'ftp.byfly.by', 'port': 80})
ok: [centos] => (item={'url': 'pypi.org', 'port': 443})
ok: [ubuntu] => (item={'url': 'pypi.org', 'port': 443})

TASK [check : Check connection to doker] ***********************************************************************************************************
Thursday 08 April 2021  06:46:53 +0000 (0:00:03.435)       0:00:43.028 ********
ok: [centos] => (item=https://registry.hub.docker.com)
ok: [ubuntu] => (item=https://registry.hub.docker.com)

TASK [check : Print output] ************************************************************************************************************************
Thursday 08 April 2021  06:46:55 +0000 (0:00:02.038)       0:00:45.066 ********
ok: [centos] => (item=200) => {
    "msg": "200"
}
ok: [ubuntu] => (item=200) => {
    "msg": "200"
}

TASK [check : Check RAM] ***************************************************************************************************************************
Thursday 08 April 2021  06:46:55 +0000 (0:00:00.271)       0:00:45.338 ********
ok: [centos] => (item={'real': {'total': 4096, 'used': 203, 'free': 3893}, 'swap': {'cached': 0, 'total': 6144, 'free': 6141, 'used': 3}, 'nocache': {'used': 126, 'free': 3970}}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "item": {
        "nocache": {
            "free": 3970,
            "used": 126
        },
        "real": {
            "free": 3893,
            "total": 4096,
            "used": 203
        },
        "swap": {
            "cached": 0,
            "free": 6141,
            "total": 6144,
            "used": 3
        }
    },
    "msg": "All assertions passed"
}
ok: [ubuntu] => (item={'real': {'total': 4096, 'used': 338, 'free': 3758}, 'nocache': {'free': 3976, 'used': 120}, 'swap': {'total': 6144, 'free': 6143, 'used': 1, 'cached': 0}}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "item": {
        "nocache": {
            "free": 3976,
            "used": 120
        },
        "real": {
            "free": 3758,
            "total": 4096,
            "used": 338
        },
        "swap": {
            "cached": 0,
            "free": 6143,
            "total": 6144,
            "used": 1
        }
    },
    "msg": "All assertions passed"
}

TASK [check : Check free space] ********************************************************************************************************************
Thursday 08 April 2021  06:46:56 +0000 (0:00:00.343)       0:00:45.682 ********
ok: [centos] => (item={'block_used': 466896, 'uuid': 'N/A', 'size_total': 21003583488, 'block_total': 5127828, 'mount': '/', 'block_available': 4660932, 'size_available': 19091177472, 'fstype': 'ext4', 'inode_total': 1310720, 'options': 'rw,relatime', 'device': '/dev/loop4', 'inode_used': 22990, 'block_size': 4096, 'inode_available': 1287730}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "item": {
        "block_available": 4660932,
        "block_size": 4096,
        "block_total": 5127828,
        "block_used": 466896,
        "device": "/dev/loop4",
        "fstype": "ext4",
        "inode_available": 1287730,
        "inode_total": 1310720,
        "inode_used": 22990,
        "mount": "/",
        "options": "rw,relatime",
        "size_available": 19091177472,
        "size_total": 21003583488,
        "uuid": "N/A"
    },
    "msg": "All assertions passed"
}
ok: [ubuntu] => (item={'mount': '/', 'device': '/dev/loop5', 'fstype': 'ext4', 'options': 'rw,relatime', 'size_total': 21003583488, 'size_available': 18640732160, 'block_size': 4096, 'block_total': 5127828, 'block_available': 4550960, 'block_used': 576868, 'inode_total': 1310720, 'inode_available': 1283582, 'inode_used': 27138, 'uuid': 'N/A'}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "item": {
        "block_available": 4550960,
        "block_size": 4096,
        "block_total": 5127828,
        "block_used": 576868,
        "device": "/dev/loop5",
        "fstype": "ext4",
        "inode_available": 1283582,
        "inode_total": 1310720,
        "inode_used": 27138,
        "mount": "/",
        "options": "rw,relatime",
        "size_available": 18640732160,
        "size_total": 21003583488,
        "uuid": "N/A"
    },
    "msg": "All assertions passed"
}

RUNNING HANDLER [webserver : restart nginx] ********************************************************************************************************
Thursday 08 April 2021  06:46:56 +0000 (0:00:00.374)       0:00:46.056 ********
changed: [ubuntu]
changed: [centos]

PLAY RECAP *****************************************************************************************************************************************
centos                     : ok=22   changed=4    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0
ubuntu                     : ok=19   changed=3    unreachable=0    failed=0    skipped=7    rescued=0    ignored=0

Thursday 08 April 2021  06:46:58 +0000 (0:00:01.771)       0:00:47.827 ********
===============================================================================
webserver : Nginx-Debian. Install packages ------------------------------------------------------------------------------------------------- 10.36s
check : Check public repositories ----------------------------------------------------------------------------------------------------------- 3.43s
Gathering Facts ----------------------------------------------------------------------------------------------------------------------------- 3.41s
webserver : Copy Home Page Ubuntu ----------------------------------------------------------------------------------------------------------- 2.80s
webserver : Check content to the sites ------------------------------------------------------------------------------------------------------ 2.66s
webserver : Copy Home Page CentOS ----------------------------------------------------------------------------------------------------------- 2.07s
check : Check connection to doker ----------------------------------------------------------------------------------------------------------- 2.04s
webserver : Nginx. Enable and start servce -------------------------------------------------------------------------------------------------- 1.99s
webserver : Templates ----------------------------------------------------------------------------------------------------------------------- 1.85s
webserver : restart nginx ------------------------------------------------------------------------------------------------------------------- 1.77s
webserver : reload service firewalld -------------------------------------------------------------------------------------------------------- 1.74s
webserver : Add epel-release repo ----------------------------------------------------------------------------------------------------------- 1.67s
webserver : CentOS. Enable firewall port ---------------------------------------------------------------------------------------------------- 1.61s
webserver : Remove Index File Ubuntu -------------------------------------------------------------------------------------------------------- 1.37s
webserver : Check connection to Localhost --------------------------------------------------------------------------------------------------- 1.27s
webserver : Nginx-RedHat. Install packages -------------------------------------------------------------------------------------------------- 1.26s
webserver : Nginx. Enable and start servce -------------------------------------------------------------------------------------------------- 1.24s
webserver : Remove Index File CentOS -------------------------------------------------------------------------------------------------------- 1.21s
webserver : Check template ------------------------------------------------------------------------------------------------------------------ 1.16s
check : Check SUDO with NOPASSWD ------------------------------------------------------------------------------------------------------------ 1.08s
Playbook run took 0 days, 0 hours, 0 minutes, 47 seconds

```

### Molecule test on CentOS, Debian, Alpine docker containers

```

INFO     default scenario test matrix: dependency, lint, cleanup, destroy, syntax, create, prepare, converge, idempotence, side_effect, verify, cleanup, destroy
INFO     Performing prerun...
INFO     Added ANSIBLE_ROLES_PATH=~/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:../../../.cache/roles
INFO     Running default > dependency
WARNING  Skipping, missing the requirements file.
WARNING  Skipping, missing the requirements file.
INFO     Running default > lint
INFO     Lint is disabled.
INFO     Running default > cleanup
WARNING  Skipping, cleanup playbook not configured.
INFO     Running default > destroy
INFO     Sanity checks: 'docker'

PLAY [Destroy] *************************************************************************************************************************************

TASK [Destroy molecule instance(s)] ****************************************************************************************************************
changed: [localhost] => (item=instance_centos)
changed: [localhost] => (item=instance_debian)
changed: [localhost] => (item=instance_alpine)

TASK [Wait for instance(s) deletion to complete] ***************************************************************************************************
ok: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '996027794352.53301', 'results_file': '/home/apachy/.ansible_async/996027794352.53301', 'changed': True, 'failed': False, 'item': {'image': 'centos:latest', 'name': 'instance_centos'}, 'ansible_loop_var': 'item'})
ok: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '236271406066.53327', 'results_file': '/home/apachy/.ansible_async/236271406066.53327', 'changed': True, 'failed': False, 'item': {'image': 'debian:latest', 'name': 'instance_debian'}, 'ansible_loop_var': 'item'})
ok: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '739379406124.53351', 'results_file': '/home/apachy/.ansible_async/739379406124.53351', 'changed': True, 'failed': False, 'item': {'image': 'alpine:latest', 'name': 'instance_alpine'}, 'ansible_loop_var': 'item'})

TASK [Delete docker network(s)] ********************************************************************************************************************

PLAY RECAP *****************************************************************************************************************************************
localhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0

INFO     Running default > syntax

playbook: /home/apachy/ansible/roles/check/molecule/default/converge.yml
INFO     Running default > create

PLAY [Create] **************************************************************************************************************************************

TASK [Log into a Docker registry] ******************************************************************************************************************
skipping: [localhost] => (item={'image': 'centos:latest', 'name': 'instance_centos'})
skipping: [localhost] => (item={'image': 'debian:latest', 'name': 'instance_debian'})
skipping: [localhost] => (item={'image': 'alpine:latest', 'name': 'instance_alpine'})

TASK [Check presence of custom Dockerfiles] ********************************************************************************************************
ok: [localhost] => (item={'image': 'centos:latest', 'name': 'instance_centos'})
ok: [localhost] => (item={'image': 'debian:latest', 'name': 'instance_debian'})
ok: [localhost] => (item={'image': 'alpine:latest', 'name': 'instance_alpine'})

TASK [Create Dockerfiles from image names] *********************************************************************************************************
changed: [localhost] => (item={'image': 'centos:latest', 'name': 'instance_centos'})
changed: [localhost] => (item={'image': 'debian:latest', 'name': 'instance_debian'})
changed: [localhost] => (item={'image': 'alpine:latest', 'name': 'instance_alpine'})

TASK [Discover local Docker images] ****************************************************************************************************************
ok: [localhost] => (item={'diff': [], 'dest': '/home/apachy/.cache/molecule/check/default/Dockerfile_centos_latest', 'src': '/home/apachy/.ansible/tmp/ansible-tmp-1617888184.1231005-56577794675576/source', 'md5sum': '486f0d15e9274e1138af32fda1a13383', 'checksum': 'f124d4f070e89bdc3bb7293530584edcfaaf6863', 'changed': True, 'uid': 1000, 'gid': 1000, 'owner': 'apachy', 'group': 'apachy', 'mode': '0600', 'state': 'file', 'size': 1042, 'invocation': {'module_args': {'src': '/home/apachy/.ansible/tmp/ansible-tmp-1617888184.1231005-56577794675576/source', 'dest': '/home/apachy/.cache/molecule/check/default/Dockerfile_centos_latest', 'mode': '0600', 'follow': False, '_original_basename': 'Dockerfile.j2', 'checksum': 'f124d4f070e89bdc3bb7293530584edcfaaf6863', 'backup': False, 'force': True, 'content': None, 'validate': None, 'directory_mode': None, 'remote_src': None, 'local_follow': None, 'owner': None, 'group': None, 'seuser': None, 'serole': None, 'selevel': None, 'setype': None, 'attributes': None, 'regexp': None, 'delimiter': None, 'unsafe_writes': None}}, 'failed': False, 'item': {'image': 'centos:latest', 'name': 'instance_centos'}, 'ansible_loop_var': 'item', 'i': 0, 'ansible_index_var': 'i'})
ok: [localhost] => (item={'diff': [], 'dest': '/home/apachy/.cache/molecule/check/default/Dockerfile_debian_latest', 'src': '/home/apachy/.ansible/tmp/ansible-tmp-1617888186.3187628-14861291679509/source', 'md5sum': '649ddebedb96fceb09c1164c59bba0a1', 'checksum': '4c3834ad7b5c2728f426ba189b14721ca5b7bce8', 'changed': True, 'uid': 1000, 'gid': 1000, 'owner': 'apachy', 'group': 'apachy', 'mode': '0600', 'state': 'file', 'size': 1042, 'invocation': {'module_args': {'src': '/home/apachy/.ansible/tmp/ansible-tmp-1617888186.3187628-14861291679509/source', 'dest': '/home/apachy/.cache/molecule/check/default/Dockerfile_debian_latest', 'mode': '0600', 'follow': False, '_original_basename': 'Dockerfile.j2', 'checksum': '4c3834ad7b5c2728f426ba189b14721ca5b7bce8', 'backup': False, 'force': True, 'content': None, 'validate': None, 'directory_mode': None, 'remote_src': None, 'local_follow': None, 'owner': None, 'group': None, 'seuser': None, 'serole': None, 'selevel': None, 'setype': None, 'attributes': None, 'regexp': None, 'delimiter': None, 'unsafe_writes': None}}, 'failed': False, 'item': {'image': 'debian:latest', 'name': 'instance_debian'}, 'ansible_loop_var': 'item', 'i': 1, 'ansible_index_var': 'i'})
ok: [localhost] => (item={'diff': [], 'dest': '/home/apachy/.cache/molecule/check/default/Dockerfile_alpine_latest', 'src': '/home/apachy/.ansible/tmp/ansible-tmp-1617888187.9227777-246920483104499/source', 'md5sum': '7afa46f0c37e979894df3e5672da18f3', 'checksum': 'dc8c728b9401723fa718cf4a0e69a19a7890df35', 'changed': True, 'uid': 1000, 'gid': 1000, 'owner': 'apachy', 'group': 'apachy', 'mode': '0600', 'state': 'file', 'size': 1042, 'invocation': {'module_args': {'src': '/home/apachy/.ansible/tmp/ansible-tmp-1617888187.9227777-246920483104499/source', 'dest': '/home/apachy/.cache/molecule/check/default/Dockerfile_alpine_latest', 'mode': '0600', 'follow': False, '_original_basename': 'Dockerfile.j2', 'checksum': 'dc8c728b9401723fa718cf4a0e69a19a7890df35', 'backup': False, 'force': True, 'content': None, 'validate': None, 'directory_mode': None, 'remote_src': None, 'local_follow': None, 'owner': None, 'group': None, 'seuser': None, 'serole': None, 'selevel': None, 'setype': None, 'attributes': None, 'regexp': None, 'delimiter': None, 'unsafe_writes': None}}, 'failed': False, 'item': {'image': 'alpine:latest', 'name': 'instance_alpine'}, 'ansible_loop_var': 'item', 'i': 2, 'ansible_index_var': 'i'})

TASK [Build an Ansible compatible image (new)] *****************************************************************************************************
ok: [localhost] => (item=molecule_local/centos:latest)
ok: [localhost] => (item=molecule_local/debian:latest)
ok: [localhost] => (item=molecule_local/alpine:latest)

TASK [Create docker network(s)] ********************************************************************************************************************

TASK [Determine the CMD directives] ****************************************************************************************************************
ok: [localhost] => (item={'image': 'centos:latest', 'name': 'instance_centos'})
ok: [localhost] => (item={'image': 'debian:latest', 'name': 'instance_debian'})
ok: [localhost] => (item={'image': 'alpine:latest', 'name': 'instance_alpine'})

TASK [Create molecule instance(s)] *****************************************************************************************************************
changed: [localhost] => (item=instance_centos)
changed: [localhost] => (item=instance_debian)
changed: [localhost] => (item=instance_alpine)

TASK [Wait for instance(s) creation to complete] ***************************************************************************************************
changed: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '357416032477.53917', 'results_file': '/home/apachy/.ansible_async/357416032477.53917', 'changed': True, 'failed': False, 'item': {'image': 'centos:latest', 'name': 'instance_centos'}, 'ansible_loop_var': 'item'})
changed: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '854461575617.53943', 'results_file': '/home/apachy/.ansible_async/854461575617.53943', 'changed': True, 'failed': False, 'item': {'image': 'debian:latest', 'name': 'instance_debian'}, 'ansible_loop_var': 'item'})
changed: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '640499245542.53979', 'results_file': '/home/apachy/.ansible_async/640499245542.53979', 'changed': True, 'failed': False, 'item': {'image': 'alpine:latest', 'name': 'instance_alpine'}, 'ansible_loop_var': 'item'})

PLAY RECAP *****************************************************************************************************************************************
localhost                  : ok=7    changed=3    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0

INFO     Running default > prepare
WARNING  Skipping, prepare playbook not configured.
INFO     Running default > converge

PLAY [Converge] ************************************************************************************************************************************

TASK [Gathering Facts] *****************************************************************************************************************************
ok: [instance_debian]
ok: [instance_alpine]
ok: [instance_centos]

TASK [Include check] *******************************************************************************************************************************

TASK [check : Check SUDO with NOPASSWD] ************************************************************************************************************
ok: [instance_debian]
ok: [instance_alpine]
ok: [instance_centos]

TASK [check : Check public repositories] ***********************************************************************************************************
ok: [instance_debian] => (item={'url': 'ftp.by.debian.org', 'port': 80})
ok: [instance_centos] => (item={'url': 'ftp.by.debian.org', 'port': 80})
ok: [instance_alpine] => (item={'url': 'ftp.by.debian.org', 'port': 80})
ok: [instance_debian] => (item={'url': 'ftp.byfly.by', 'port': 80})
ok: [instance_centos] => (item={'url': 'ftp.byfly.by', 'port': 80})
ok: [instance_alpine] => (item={'url': 'ftp.byfly.by', 'port': 80})
ok: [instance_debian] => (item={'url': 'pypi.org', 'port': 443})
ok: [instance_centos] => (item={'url': 'pypi.org', 'port': 443})
ok: [instance_alpine] => (item={'url': 'pypi.org', 'port': 443})

TASK [check : Check connection to doker] ***********************************************************************************************************
ok: [instance_centos] => (item=https://registry.hub.docker.com)
ok: [instance_debian] => (item=https://registry.hub.docker.com)
ok: [instance_alpine] => (item=https://registry.hub.docker.com)

TASK [check : Print output] ************************************************************************************************************************
ok: [instance_alpine] => (item=200) => {
    "msg": "200"
}
ok: [instance_centos] => (item=200) => {
    "msg": "200"
}
ok: [instance_debian] => (item=200) => {
    "msg": "200"
}

TASK [check : Check RAM] ***************************************************************************************************************************
failed: [instance_alpine] (item={'real': {'total': 981, 'used': 870, 'free': 111}, 'nocache': {'free': 507, 'used': 474}, 'swap': {'total': 1961, 'free': 1922, 'used': 39, 'cached': 2}}) => {
    "ansible_loop_var": "item",
    "assertion": "ansible_memtotal_mb >= 2024",
    "changed": false,
    "evaluated_to": false,
    "item": {
        "nocache": {
            "free": 507,
            "used": 474
        },
        "real": {
            "free": 111,
            "total": 981,
            "used": 870
        },
        "swap": {
            "cached": 2,
            "free": 1922,
            "total": 1961,
            "used": 39
        }
    },
    "msg": "Host has enough RAM"
}
failed: [instance_centos] (item={'real': {'total': 981, 'used': 861, 'free': 120}, 'nocache': {'free': 508, 'used': 473}, 'swap': {'total': 1961, 'free': 1922, 'used': 39, 'cached': 2}}) => {
    "ansible_loop_var": "item",
    "assertion": "ansible_memtotal_mb >= 2024",
    "changed": false,
    "evaluated_to": false,
    "item": {
        "nocache": {
            "free": 508,
            "used": 473
        },
        "real": {
            "free": 120,
            "total": 981,
            "used": 861
        },
        "swap": {
            "cached": 2,
            "free": 1922,
            "total": 1961,
            "used": 39
        }
    },
    "msg": "Host has enough RAM"
}
failed: [instance_debian] (item={'real': {'total': 981, 'used': 898, 'free': 83}, 'nocache': {'free': 469, 'used': 512}, 'swap': {'total': 1961, 'free': 1922, 'used': 39, 'cached': 2}}) => {
    "ansible_loop_var": "item",
    "assertion": "ansible_memtotal_mb >= 2024",
    "changed": false,
    "evaluated_to": false,
    "item": {
        "nocache": {
            "free": 469,
            "used": 512
        },
        "real": {
            "free": 83,
            "total": 981,
            "used": 898
        },
        "swap": {
            "cached": 2,
            "free": 1922,
            "total": 1961,
            "used": 39
        }
    },
    "msg": "Host has enough RAM"
}

PLAY RECAP *****************************************************************************************************************************************
instance_alpine            : ok=5    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0
instance_centos            : ok=5    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0
instance_debian            : ok=5    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0

CRITICAL Ansible return code was 2, command was: ansible-playbook --inventory /home/apachy/.cache/molecule/check/default/inventory --skip-tags molecule-notest,notest /home/apachy/ansible/roles/check/molecule/default/converge.yml
WARNING  An error occurred during the test sequence action: 'converge'. Cleaning up.
INFO     Running default > cleanup
WARNING  Skipping, cleanup playbook not configured.
INFO     Running default > destroy

PLAY [Destroy] *************************************************************************************************************************************

TASK [Destroy molecule instance(s)] ****************************************************************************************************************
changed: [localhost] => (item=instance_centos)
changed: [localhost] => (item=instance_debian)
changed: [localhost] => (item=instance_alpine)

TASK [Wait for instance(s) deletion to complete] ***************************************************************************************************
changed: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '20461362169.57745', 'results_file': '/home/apachy/.ansible_async/20461362169.57745', 'changed': True, 'failed': False, 'item': {'image': 'centos:latest', 'name': 'instance_centos'}, 'ansible_loop_var': 'item'})
changed: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '248111564218.57771', 'results_file': '/home/apachy/.ansible_async/248111564218.57771', 'changed': True, 'failed': False, 'item': {'image': 'debian:latest', 'name': 'instance_debian'}, 'ansible_loop_var': 'item'})
changed: [localhost] => (item={'started': 1, 'finished': 0, 'ansible_job_id': '847790308775.57795', 'results_file': '/home/apachy/.ansible_async/847790308775.57795', 'changed': True, 'failed': False, 'item': {'image': 'alpine:latest', 'name': 'instance_alpine'}, 'ansible_loop_var': 'item'})

TASK [Delete docker network(s)] ********************************************************************************************************************

PLAY RECAP *****************************************************************************************************************************************
localhost                  : ok=2    changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0

INFO     Pruning extra files from scenario ephemeral directory

```

# Implement testing role

* Check if we have SUDO with NOPASSWD
* Checks to public repository (debian/centos and pip)
* Check if we have connection to docker hub registry (return content check)
* Check if we have enough RAM/HDD (you can create thresholds by yourself)

```
        kristoit@M-SA2-Ubuntu:~/ansi/08$ ansible-playbook checks.yaml -i inv.yaml 

        PLAY [webservers] ******************************************************************************************************

        TASK [Gathering Facts] *************************************************************************************************
        Friday 13 September 2019  00:08:06 +0300 (0:00:00.075)       0:00:00.075 ****** 
        ok: [lab-centos01]
        ok: [lab-ubuntu01]

        TASK [check : Make sure we have user with sudo and NOPASSWD] ***********************************************************
        Friday 13 September 2019  00:08:08 +0300 (0:00:02.847)       0:00:02.923 ****** 
        ok: [lab-ubuntu01]
        ok: [lab-centos01]

        TASK [check : Check user permission] ***********************************************************************************
        Friday 13 September 2019  00:08:09 +0300 (0:00:01.015)       0:00:03.938 ****** 
        ok: [lab-ubuntu01] => {
            "msg": "NewTestUserKri2 ALL=(ALL)  NOPASSWD: ALL"
        }
        ok: [lab-centos01] => {
            "msg": "NewTestUserKri2 ALL=(ALL)  NOPASSWD: ALL"
        }

        TASK [check : Check public repository Ubuntu system] *******************************************************************
        Friday 13 September 2019  00:08:10 +0300 (0:00:00.137)       0:00:04.076 ****** 
        skipping: [lab-centos01]
        ok: [lab-ubuntu01]

        TASK [check : Output public repository Ubuntu system] ******************************************************************
        Friday 13 September 2019  00:08:10 +0300 (0:00:00.554)       0:00:04.630 ****** 
        ok: [lab-ubuntu01] => {
            "msg": [
                "deb http://us.archive.ubuntu.com/ubuntu bionic main restricted", 
                "deb http://us.archive.ubuntu.com/ubuntu bionic-updates main restricted", 
                "deb http://us.archive.ubuntu.com/ubuntu bionic universe", 
                "deb http://us.archive.ubuntu.com/ubuntu bionic-updates universe", 
                "deb http://us.archive.ubuntu.com/ubuntu bionic multiverse", 
                "deb http://us.archive.ubuntu.com/ubuntu bionic-updates multiverse", 
                "deb http://us.archive.ubuntu.com/ubuntu bionic-backports main restricted universe multiverse", 
                "deb http://security.ubuntu.com/ubuntu bionic-security main restricted", 
                "deb http://security.ubuntu.com/ubuntu bionic-security universe", 
                "deb http://security.ubuntu.com/ubuntu bionic-security multiverse"
            ]
        }
        skipping: [lab-centos01]

        TASK [check : Check public repository CentOS system] *******************************************************************
        Friday 13 September 2019  00:08:10 +0300 (0:00:00.132)       0:00:04.763 ****** 
        skipping: [lab-ubuntu01]
        ok: [lab-centos01]

        TASK [check : Output public repository CentOS system] ******************************************************************
        Friday 13 September 2019  00:08:11 +0300 (0:00:00.707)       0:00:05.471 ****** 
        skipping: [lab-ubuntu01]
        ok: [lab-centos01] => {
            "msg": [
                "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra", 
                "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates&infra=$infra", 
                "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras&infra=$infra", 
                "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=centosplus&infra=$infra", 
                "baseurl=http://mirror.centos.org/centos/$releasever/cr/$basearch/", 
                "baseurl=http://debuginfo.centos.org/7/$basearch/", 
                "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=fasttrack&infra=$infra", 
                "baseurl=http://vault.centos.org/centos/$releasever/os/Source/", 
                "baseurl=http://vault.centos.org/centos/$releasever/updates/Source/", 
                "baseurl=http://vault.centos.org/centos/$releasever/extras/Source/", 
                "baseurl=http://vault.centos.org/centos/$releasever/centosplus/Source/", 
                "baseurl=http://vault.centos.org/7.0.1406/os/$basearch/", 
                "baseurl=http://vault.centos.org/7.0.1406/updates/$basearch/", 
                "baseurl=http://vault.centos.org/7.0.1406/extras/$basearch/", 
                "baseurl=http://vault.centos.org/7.0.1406/centosplus/$basearch/", 
                "baseurl=http://vault.centos.org/7.0.1406/fasttrack/$basearch/", 
                "baseurl=http://vault.centos.org/7.1.1503/os/$basearch/", 
                "baseurl=http://vault.centos.org/7.1.1503/updates/$basearch/", 
                "baseurl=http://vault.centos.org/7.1.1503/extras/$basearch/", 
                "baseurl=http://vault.centos.org/7.1.1503/centosplus/$basearch/", 
                "baseurl=http://vault.centos.org/7.1.1503/fasttrack/$basearch/", 
                "baseurl=http://vault.centos.org/7.2.1511/os/$basearch/", 
                "baseurl=http://vault.centos.org/7.2.1511/updates/$basearch/", 
                "baseurl=http://vault.centos.org/7.2.1511/extras/$basearch/", 
                "baseurl=http://vault.centos.org/7.2.1511/centosplus/$basearch/", 
                "baseurl=http://vault.centos.org/7.2.1511/fasttrack/$basearch/", 
                "baseurl=http://vault.centos.org/7.3.1611/os/$basearch/", 
                "baseurl=http://vault.centos.org/7.3.1611/updates/$basearch/", 
                "baseurl=http://vault.centos.org/7.3.1611/extras/$basearch/", 
                "baseurl=http://vault.centos.org/7.3.1611/centosplus/$basearch/", 
                "baseurl=http://vault.centos.org/7.3.1611/fasttrack/$basearch/", 
                "baseurl=http://vault.centos.org/7.4.1708/os/$basearch/", 
                "baseurl=http://vault.centos.org/7.4.1708/updates/$basearch/", 
                "baseurl=http://vault.centos.org/7.4.1708/extras/$basearch/", 
                "baseurl=http://vault.centos.org/7.4.1708/centosplus/$basearch/", 
                "baseurl=http://vault.centos.org/7.4.1708/fasttrack/$basearch/", 
                "baseurl=http://vault.centos.org/7.5.1804/os/$basearch/", 
                "baseurl=http://vault.centos.org/7.5.1804/updates/$basearch/", 
                "baseurl=http://vault.centos.org/7.5.1804/extras/$basearch/", 
                "baseurl=http://vault.centos.org/7.5.1804/centosplus/$basearch/", 
                "baseurl=http://vault.centos.org/7.5.1804/fasttrack/$basearch/", 
                "metalink=https://mirrors.fedoraproject.org/metalink?repo=epel-7&arch=$basearch", 
                "metalink=https://mirrors.fedoraproject.org/metalink?repo=epel-debug-7&arch=$basearch", 
                "metalink=https://mirrors.fedoraproject.org/metalink?repo=epel-source-7&arch=$basearch", 
                "metalink=https://mirrors.fedoraproject.org/metalink?repo=testing-epel7&arch=$basearch", 
                "metalink=https://mirrors.fedoraproject.org/metalink?repo=testing-debug-epel7&arch=$basearch", 
                "metalink=https://mirrors.fedoraproject.org/metalink?repo=testing-source-epel7&arch=$basearch"
            ]   
        }

        TASK [check : Chek for available disk space] ***************************************************************************
        Friday 13 September 2019  00:08:11 +0300 (0:00:00.144)       0:00:05.616 ****** 
        ok: [lab-ubuntu01] => (item={u'block_used': 1096915, u'uuid': u'88d0b97e-c960-4a39-afec-0276c44e01f5', u'size_total': 31165706240, u'block_total': 7608815, u'mount': u'/', u'block_available': 6511900, u'size_available': 26672742400, u'fstype': u'ext4', u'inode_total': 1941504, u'inode_available': 1792776, u'device': u'/dev/sda3', u'inode_used': 148728, u'block_size': 4096, u'options': u'rw,relatime,errors=remount-ro,data=ordered'}) => {
            "ansible_loop_var": "item", 
            "changed": false, 
            "item": {
                "block_available": 6511900, 
                "block_size": 4096, 
                "block_total": 7608815, 
                "block_used": 1096915, 
                "device": "/dev/sda3", 
                "fstype": "ext4", 
                "inode_available": 1792776, 
                "inode_total": 1941504, 
                "inode_used": 148728, 
                "mount": "/", 
                "options": "rw,relatime,errors=remount-ro,data=ordered", 
                "size_available": 26672742400, 
                "size_total": 31165706240, 
                "uuid": "88d0b97e-c960-4a39-afec-0276c44e01f5"
            }, 
            "msg": "All assertions passed"
        }
        ok: [lab-ubuntu01] => (item={u'block_used': 243831, u'uuid': u'82262a10-3633-4eff-9122-638a47c24c96', u'size_total': 486105088, u'block_total': 474712, u'mount': u'/boot', u'block_available': 230881, u'size_available': 236422144, u'fstype': u'ext4', u'inode_total': 124928, u'inode_available': 124611, u'device': u'/dev/sda1', u'inode_used': 317, u'block_size': 1024, u'options': u'rw,relatime,data=ordered'}) => {
            "ansible_loop_var": "item", 
            "changed": false, 
            "item": {
                "block_available": 230881, 
                "block_size": 1024, 
                "block_total": 474712, 
                "block_used": 243831, 
                "device": "/dev/sda1", 
                "fstype": "ext4", 
                "inode_available": 124611, 
                "inode_total": 124928, 
                "inode_used": 317, 
                "mount": "/boot", 
                "options": "rw,relatime,data=ordered", 
                "size_available": 236422144, 
                "size_total": 486105088, 
                "uuid": "82262a10-3633-4eff-9122-638a47c24c96"
            }, 
            "msg": "All assertions passed"
        }
        ok: [lab-centos01] => (item={u'block_used': 783132, u'uuid': u'8ac075e3-1124-4bb6-bef7-a6811bf8b870', u'size_total': 42927656960, u'block_total': 10480385, u'mount': u'/', u'block_available': 9697253, u'size_available': 39719948288, u'fstype': u'xfs', u'inode_total': 20971008, u'inode_available': 20938475, u'device': u'/dev/sda1', u'inode_used': 32533, u'block_size': 4096, u'options': u'rw,seclabel,relatime,attr2,inode64,noquota'}) => {
            "ansible_loop_var": "item", 
            "changed": false, 
            "item": {
                "block_available": 9697253, 
                "block_size": 4096, 
                "block_total": 10480385, 
                "block_used": 783132, 
                "device": "/dev/sda1", 
                "fstype": "xfs", 
                "inode_available": 20938475, 
                "inode_total": 20971008, 
                "inode_used": 32533, 
                "mount": "/", 
                "options": "rw,seclabel,relatime,attr2,inode64,noquota", 
                "size_available": 39719948288, 
                "size_total": 42927656960, 
                "uuid": "8ac075e3-1124-4bb6-bef7-a6811bf8b870"
            }, 
            "msg": "All assertions passed"
        }

        TASK [check : Available disk space] ************************************************************************************
        Friday 13 September 2019  00:08:11 +0300 (0:00:00.165)       0:00:05.782 ****** 
        ok: [lab-ubuntu01] => {
            "msg": {
                "changed": false, 
                "msg": "All items completed", 
                "results": [
                    {
                        "ansible_loop_var": "item", 
                        "changed": false, 
                        "failed": false, 
                        "item": {
                            "block_available": 6511900, 
                            "block_size": 4096, 
                            "block_total": 7608815, 
                            "block_used": 1096915, 
                            "device": "/dev/sda3", 
                            "fstype": "ext4", 
                            "inode_available": 1792776, 
                            "inode_total": 1941504, 
                            "inode_used": 148728, 
                            "mount": "/", 
                            "options": "rw,relatime,errors=remount-ro,data=ordered", 
                            "size_available": 26672742400, 
                            "size_total": 31165706240, 
                            "uuid": "88d0b97e-c960-4a39-afec-0276c44e01f5"
                        }, 
                        "msg": "All assertions passed"
                    }, 
                    {
                        "ansible_loop_var": "item", 
                        "changed": false, 
                        "failed": false, 
                        "item": {
                            "block_available": 230881, 
                            "block_size": 1024, 
                            "block_total": 474712, 
                            "block_used": 243831, 
                            "device": "/dev/sda1", 
                            "fstype": "ext4", 
                            "inode_available": 124611, 
                            "inode_total": 124928, 
                            "inode_used": 317, 
                            "mount": "/boot", 
                            "options": "rw,relatime,data=ordered", 
                            "size_available": 236422144, 
                            "size_total": 486105088, 
                            "uuid": "82262a10-3633-4eff-9122-638a47c24c96"
                        }, 
                        "msg": "All assertions passed"
                    }
                ]
            }
        }
        ok: [lab-centos01] => {
            "msg": {
                "changed": false, 
                "msg": "All items completed", 
                "results": [
                    {
                        "ansible_loop_var": "item", 
                        "changed": false, 
                        "failed": false, 
                        "item": {
                            "block_available": 9697253, 
                            "block_size": 4096, 
                            "block_total": 10480385, 
                            "block_used": 783132, 
                            "device": "/dev/sda1", 
                            "fstype": "xfs", 
                            "inode_available": 20938475, 
                            "inode_total": 20971008, 
                            "inode_used": 32533, 
                            "mount": "/", 
                            "options": "rw,seclabel,relatime,attr2,inode64,noquota", 
                            "size_available": 39719948288, 
                            "size_total": 42927656960, 
                            "uuid": "8ac075e3-1124-4bb6-bef7-a6811bf8b870"
                        }, 
                        "msg": "All assertions passed"
                    }
                ]
            }
        }

        TASK [check : Alarm not free disk space] *******************************************************************************
        Friday 13 September 2019  00:08:11 +0300 (0:00:00.132)       0:00:05.915 ****** 
        skipping: [lab-ubuntu01]
        skipping: [lab-centos01]

        TASK [check : Chek for available memory] *******************************************************************************
        Friday 13 September 2019  00:08:11 +0300 (0:00:00.131)       0:00:06.046 ****** 
        ok: [lab-ubuntu01] => {
            "msg": "total RAM is 1993"
        }
        ok: [lab-centos01] => {
            "msg": "total RAM is 1838"
        }

        TASK [check : alarm check memory free] *********************************************************************************
        Friday 13 September 2019  00:08:12 +0300 (0:00:00.135)       0:00:06.181 ****** 
        skipping: [lab-ubuntu01]
        skipping: [lab-centos01]

        PLAY [localhost] *******************************************************************************************************

        TASK [Gathering Facts] *************************************************************************************************
        Friday 13 September 2019  00:08:12 +0300 (0:00:00.104)       0:00:06.285 ****** 
        ok: [localhost]

        TASK [localcheck : Check dockerhub] ************************************************************************************
        Friday 13 September 2019  00:08:13 +0300 (0:00:01.147)       0:00:07.433 ****** 
        ok: [localhost]

        TASK [localcheck : Print output docker hub registry] *******************************************************************
        Friday 13 September 2019  00:08:15 +0300 (0:00:02.079)       0:00:09.513 ****** 
        ok: [localhost] => {
            "msg": "200"
        }

        TASK [localcheck : Check pip repository] *******************************************************************************
        Friday 13 September 2019  00:08:15 +0300 (0:00:00.098)       0:00:09.612 ****** 
        ok: [localhost]

        TASK [localcheck : Print pip repository] *******************************************************************************
        Friday 13 September 2019  00:08:17 +0300 (0:00:01.742)       0:00:11.355 ****** 
        ok: [localhost] => {
            "msg": [
                "Found index url https://pypi.org/simple"
            ]
        }

        PLAY RECAP *************************************************************************************************************
        lab-centos01               : ok=8    changed=0    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
        lab-ubuntu01               : ok=8    changed=0    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
        localhost                  : ok=5    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

        Friday 13 September 2019  00:08:17 +0300 (0:00:00.032)       0:00:11.388 ****** 
        =============================================================================== 
        Gathering Facts ------------------------------------------------------------------------------------------------- 2.85s
        localcheck : Check dockerhub ------------------------------------------------------------------------------------ 2.08s
        localcheck : Check pip repository ------------------------------------------------------------------------------- 1.74s
        Gathering Facts ------------------------------------------------------------------------------------------------- 1.15s
        check : Make sure we have user with sudo and NOPASSWD ----------------------------------------------------------- 1.01s
        check : Check public repository CentOS system ------------------------------------------------------------------- 0.71s
        check : Check public repository Ubuntu system ------------------------------------------------------------------- 0.55s
        check : Chek for available disk space --------------------------------------------------------------------------- 0.17s
        check : Output public repository CentOS system ------------------------------------------------------------------ 0.14s
        check : Check user permission ----------------------------------------------------------------------------------- 0.14s
        check : Chek for available memory ------------------------------------------------------------------------------- 0.14s
        check : Available disk space ------------------------------------------------------------------------------------ 0.13s
        check : Output public repository Ubuntu system ------------------------------------------------------------------ 0.13s
        check : Alarm not free disk space ------------------------------------------------------------------------------- 0.13s
        check : alarm check memory free --------------------------------------------------------------------------------- 0.10s
        localcheck : Print output docker hub registry ------------------------------------------------------------------- 0.10s
        localcheck : Print pip repository ------------------------------------------------------------------------------- 0.03s
        kristoit@M-SA2-Ubuntu:~/ansi/08$ cd roles/
```

# Ansible-lint test
```
        kristoit@M-SA2-Ubuntu:~/ansi/08$ ansible-lint checks.yaml 
        kristoit@M-SA2-Ubuntu:~/ansi/08$ 
```

# Molecule test

```bash
# molecule init scenario

        kristoit@M-SA2-Ubuntu:~/ansi/08/roles/check$ molecule init scenario
        --> Initializing new scenario default...
        Initialized scenario in /home/kristoit/ansi/08/roles/check/molecule/default successfully.
        kristoit@M-SA2-Ubuntu:
```

```bash
# molecule lint

        kristoit@M-SA2-Ubuntu:~/ansi/08/roles/check$ molecule lint
        --> Validating schema /home/kristoit/ansi/08/roles/check/molecule/default/molecule.yml.
        Validation completed successfully.
        --> Test matrix
    
        └── default
            └── lint
    
        --> Scenario: 'default'
        --> Action: 'lint'
        --> Executing Yamllint on files found in /home/kristoit/ansi/08/roles/check/...
        Lint completed successfully.
        --> Executing Flake8 on files found in /home/kristoit/ansi/08/roles/check/molecule/default/tests/...
        Lint completed successfully.
        --> Executing Ansible Lint on /home/kristoit/ansi/08/roles/check/molecule/default/playbook.yml...
        Lint completed successfully.
        kristoit@M-SA2-Ubuntu:
```

```bash
# molecule test

        kristoit@M-SA2-Ubuntu:~/ansi/08/roles/check$ molecule test
        --> Validating schema /home/kristoit/ansi/08/roles/check/molecule/default/molecule.yml.
        Validation completed successfully.
        --> Test matrix
    
        └── default
            ├── lint
            ├── dependency
            ├── cleanup
            ├── destroy
            ├── syntax
            ├── create
            ├── prepare
            ├── converge
            ├── idempotence
            ├── side_effect
            ├── verify
            ├── cleanup
            └── destroy
    
        --> Scenario: 'default'
        --> Action: 'lint'
        --> Executing Yamllint on files found in /home/kristoit/ansi/08/roles/check/...
        Lint completed successfully.
        --> Executing Flake8 on files found in /home/kristoit/ansi/08/roles/check/molecule/default/tests/...
        Lint completed successfully.
        --> Executing Ansible Lint on /home/kristoit/ansi/08/roles/check/molecule/default/playbook.yml...
        Lint completed successfully.
        --> Scenario: 'default'
        --> Action: 'dependency'
        Skipping, missing the requirements file.
        --> Scenario: 'default'
        --> Action: 'cleanup'
        Skipping, cleanup playbook not configured.
        --> Scenario: 'default'
        --> Action: 'destroy'
        --> Sanity checks: 'docker'
    
            PLAY [Destroy] *****************************************************************
    
            TASK [Destroy molecule instance(s)] ********************************************
            changed: [localhost] => (item=instance1)
            changed: [localhost] => (item=instance2)
    
            TASK [Wait for instance(s) deletion to complete] *******************************
            ok: [localhost] => (item=None)
            ok: [localhost] => (item=None)
            ok: [localhost]
    
            TASK [Delete docker network(s)] ************************************************
    
            PLAY RECAP *********************************************************************
            localhost                  : ok=2    changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0
    
        --> Scenario: 'default'
        --> Action: 'syntax'
        --> Sanity checks: 'docker'
    
            playbook: /home/kristoit/ansi/08/roles/check/molecule/default/playbook.yml
        --> Scenario: 'default'
        --> Action: 'create'
    
            PLAY [Create] ******************************************************************
    
            TASK [Log into a Docker registry] **********************************************
            skipping: [localhost] => (item=None) 
            skipping: [localhost] => (item=None) 
    
            TASK [Create Dockerfiles from image names] *************************************
            changed: [localhost] => (item=None)
            changed: [localhost] => (item=None)
            changed: [localhost]
    
            TASK [Determine which docker image info module to use] *************************
            ok: [localhost]
    
            TASK [Discover local Docker images] ********************************************
            ok: [localhost] => (item=None)
            ok: [localhost] => (item=None)
            ok: [localhost]
    
            TASK [Build an Ansible compatible image (new)] *********************************
            ok: [localhost] => (item=molecule_local/centos:7)
            ok: [localhost] => (item=molecule_local/debian:9)
    
            TASK [Build an Ansible compatible image (old)] *********************************
            skipping: [localhost] => (item=molecule_local/centos:7) 
            skipping: [localhost] => (item=molecule_local/debian:9) 
    
            TASK [Create docker network(s)] ************************************************
    
            TASK [Determine the CMD directives] ********************************************
            ok: [localhost] => (item=None)
            ok: [localhost] => (item=None)
            ok: [localhost]
    
            TASK [Create molecule instance(s)] *********************************************
            changed: [localhost] => (item=instance1)
            changed: [localhost] => (item=instance2)
    
            TASK [Wait for instance(s) creation to complete] *******************************
            FAILED - RETRYING: Wait for instance(s) creation to complete (300 retries left).
            changed: [localhost] => (item=None)
            changed: [localhost] => (item=None)
            changed: [localhost]
    
            PLAY RECAP *********************************************************************
            localhost                  : ok=7    changed=3    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
    
        --> Scenario: 'default'
        --> Action: 'prepare'
        Skipping, prepare playbook not configured.
        --> Scenario: 'default'
        --> Action: 'converge'
    
            PLAY [Converge] ****************************************************************
    
            TASK [Gathering Facts] *********************************************************
            ok: [instance2]
            ok: [instance1]
    
            TASK [check : Make sure we have user with sudo and NOPASSWD] *******************
            fatal: [instance2]: FAILED! => {"changed": false, "cmd": ["cat", "/etc/sudoers.d/NewTestUserKri2"], "delta": "0:00:00.933696", "end": "2019-09-12 21:14:31.873248", "msg": "non-zero return code", "rc": 1, "start": "2019-09-12 21:14:30.939552", "stderr": "cat: /etc/sudoers.d/NewTestUserKri2: No such file or directory", "stderr_lines": ["cat: /etc/sudoers.d/NewTestUserKri2: No such file or directory"], "stdout": "", "stdout_lines": []}
            ...ignoring
            fatal: [instance1]: FAILED! => {"changed": false, "cmd": ["cat", "/etc/sudoers.d/NewTestUserKri2"], "delta": "0:00:00.880011", "end": "2019-09-12 21:14:31.989121", "msg": "non-zero return code", "rc": 1, "start": "2019-09-12 21:14:31.109110", "stderr": "cat: /etc/sudoers.d/NewTestUserKri2: No such file or directory", "stderr_lines": ["cat: /etc/sudoers.d/NewTestUserKri2: No such file or directory"], "stdout": "", "stdout_lines": []}
            ...ignoring
    
            TASK [check : Check user permission] *******************************************
            ok: [instance2] => {
                "msg": ""
            }
            ok: [instance1] => {
                "msg": ""
            }
    
            TASK [check : Check public repository Ubuntu system] ***************************
            skipping: [instance1]
            ok: [instance2]
    
            TASK [check : Output public repository Ubuntu system] **************************
            skipping: [instance1]
            ok: [instance2] => {
                "msg": [
                    "deb http://deb.debian.org/debian stretch main", 
                    "deb http://security.debian.org/debian-security stretch/updates main", 
                    "deb http://deb.debian.org/debian stretch-updates main"
                ]
            }
    
            TASK [check : Check public repository CentOS system] ***************************
            skipping: [instance2]
            ok: [instance1]
    
            TASK [check : Output public repository CentOS system] **************************
            skipping: [instance2]
            ok: [instance1] => {
                "msg": [
                    "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=os&infra=$infra", 
                    "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=updates&infra=$infra", 
                    "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=extras&infra=$infra", 
                    "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=centosplus&infra=$infra", 
                    "baseurl=http://mirror.centos.org/centos/$releasever/cr/$basearch/", 
                    "baseurl=http://debuginfo.centos.org/7/$basearch/", 
                    "baseurl=http://vault.centos.org/centos/$releasever/os/Source/", 
                    "baseurl=http://vault.centos.org/centos/$releasever/updates/Source/", 
                    "baseurl=http://vault.centos.org/centos/$releasever/extras/Source/", 
                    "baseurl=http://vault.centos.org/centos/$releasever/centosplus/Source/", 
                    "baseurl=http://vault.centos.org/7.0.1406/os/$basearch/", 
                    "baseurl=http://vault.centos.org/7.0.1406/updates/$basearch/", 
                    "baseurl=http://vault.centos.org/7.0.1406/extras/$basearch/", 
                    "baseurl=http://vault.centos.org/7.0.1406/centosplus/$basearch/", 
                    "baseurl=http://vault.centos.org/7.0.1406/fasttrack/$basearch/", 
                    "baseurl=http://vault.centos.org/7.1.1503/os/$basearch/", 
                    "baseurl=http://vault.centos.org/7.1.1503/updates/$basearch/", 
                    "baseurl=http://vault.centos.org/7.1.1503/extras/$basearch/", 
                    "baseurl=http://vault.centos.org/7.1.1503/centosplus/$basearch/", 
                    "baseurl=http://vault.centos.org/7.1.1503/fasttrack/$basearch/", 
                    "baseurl=http://vault.centos.org/7.2.1511/os/$basearch/", 
                    "baseurl=http://vault.centos.org/7.2.1511/updates/$basearch/", 
                    "baseurl=http://vault.centos.org/7.2.1511/extras/$basearch/", 
                    "baseurl=http://vault.centos.org/7.2.1511/centosplus/$basearch/", 
                    "baseurl=http://vault.centos.org/7.2.1511/fasttrack/$basearch/", 
                    "baseurl=http://vault.centos.org/7.3.1611/os/$basearch/", 
                    "baseurl=http://vault.centos.org/7.3.1611/updates/$basearch/", 
                    "baseurl=http://vault.centos.org/7.3.1611/extras/$basearch/", 
                    "baseurl=http://vault.centos.org/7.3.1611/centosplus/$basearch/", 
                    "baseurl=http://vault.centos.org/7.3.1611/fasttrack/$basearch/", 
                    "baseurl=http://vault.centos.org/7.4.1708/os/$basearch/", 
                    "baseurl=http://vault.centos.org/7.4.1708/updates/$basearch/", 
                    "baseurl=http://vault.centos.org/7.4.1708/extras/$basearch/", 
                    "baseurl=http://vault.centos.org/7.4.1708/centosplus/$basearch/", 
                    "baseurl=http://vault.centos.org/7.4.1708/fasttrack/$basearch/", 
                    "baseurl=http://vault.centos.org/7.5.1804/os/$basearch/", 
                    "baseurl=http://vault.centos.org/7.5.1804/updates/$basearch/", 
                    "baseurl=http://vault.centos.org/7.5.1804/extras/$basearch/", 
                    "baseurl=http://vault.centos.org/7.5.1804/centosplus/$basearch/", 
                    "baseurl=http://vault.centos.org/7.5.1804/fasttrack/$basearch/", 
                    "mirrorlist=http://mirrorlist.centos.org/?release=$releasever&arch=$basearch&repo=fasttrack&infra=$infra"
                ]
            }
    
            TASK [check : Chek for available disk space] ***********************************
            ok: [instance2] => (item={u'block_used': 928145, u'uuid': u'N/A', u'size_total': 8663535616, u'block_total': 2115121, u'mount': u'/etc/hosts', u'block_available': 1186976, u'size_available': 4861853696, u'fstype': u'ext4', u'inode_total': 545648, u'inode_available': 422173, u'device': u'/dev/mapper/M--SA2--Ubuntu--vg-root', u'inode_used': 123475, u'block_size': 4096, u'options': u'rw,relatime,errors=remount-ro,data=ordered,bind'}) => {
                "ansible_loop_var": "item", 
                "changed": false, 
                "item": {
                    "block_available": 1186976, 
                    "block_size": 4096, 
                    "block_total": 2115121, 
                    "block_used": 928145, 
                    "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                    "fstype": "ext4", 
                    "inode_available": 422173, 
                    "inode_total": 545648, 
                    "inode_used": 123475, 
                    "mount": "/etc/hosts", 
                    "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                    "size_available": 4861853696, 
                    "size_total": 8663535616, 
                    "uuid": "N/A"
                }, 
                "msg": "All assertions passed"
            }
            ok: [instance1] => (item={u'block_used': 928145, u'uuid': u'N/A', u'size_total': 8663535616, u'block_total': 2115121, u'mount': u'/etc/hostname', u'block_available': 1186976, u'size_available': 4861853696, u'fstype': u'ext4', u'inode_total': 545648, u'inode_available': 422173, u'device': u'/dev/mapper/M--SA2--Ubuntu--vg-root', u'inode_used': 123475, u'block_size': 4096, u'options': u'rw,relatime,errors=remount-ro,data=ordered,bind'}) => {
                "ansible_loop_var": "item", 
                "changed": false, 
                "item": {
                    "block_available": 1186976, 
                    "block_size": 4096, 
                    "block_total": 2115121, 
                    "block_used": 928145, 
                    "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                    "fstype": "ext4", 
                    "inode_available": 422173, 
                    "inode_total": 545648, 
                    "inode_used": 123475, 
                    "mount": "/etc/hostname", 
                    "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                    "size_available": 4861853696, 
                    "size_total": 8663535616, 
                    "uuid": "N/A"
                }, 
                "msg": "All assertions passed"
            }
            ok: [instance2] => (item={u'block_used': 928145, u'uuid': u'N/A', u'size_total': 8663535616, u'block_total': 2115121, u'mount': u'/etc/hostname', u'block_available': 1186976, u'size_available': 4861853696, u'fstype': u'ext4', u'inode_total': 545648, u'inode_available': 422173, u'device': u'/dev/mapper/M--SA2--Ubuntu--vg-root', u'inode_used': 123475, u'block_size': 4096, u'options': u'rw,relatime,errors=remount-ro,data=ordered,bind'}) => {
                "ansible_loop_var": "item", 
                "changed": false, 
                "item": {
                    "block_available": 1186976, 
                    "block_size": 4096, 
                    "block_total": 2115121, 
                    "block_used": 928145, 
                    "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                    "fstype": "ext4", 
                    "inode_available": 422173, 
                    "inode_total": 545648, 
                    "inode_used": 123475, 
                    "mount": "/etc/hostname", 
                    "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                    "size_available": 4861853696, 
                    "size_total": 8663535616, 
                    "uuid": "N/A"
                }, 
                "msg": "All assertions passed"
            }
            ok: [instance1] => (item={u'block_used': 928145, u'uuid': u'N/A', u'size_total': 8663535616, u'block_total': 2115121, u'mount': u'/etc/resolv.conf', u'block_available': 1186976, u'size_available': 4861853696, u'fstype': u'ext4', u'inode_total': 545648, u'inode_available': 422173, u'device': u'/dev/mapper/M--SA2--Ubuntu--vg-root', u'inode_used': 123475, u'block_size': 4096, u'options': u'rw,relatime,errors=remount-ro,data=ordered,bind'}) => {
                "ansible_loop_var": "item", 
                "changed": false, 
                "item": {
                    "block_available": 1186976, 
                    "block_size": 4096, 
                    "block_total": 2115121, 
                    "block_used": 928145, 
                    "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                    "fstype": "ext4", 
                    "inode_available": 422173, 
                    "inode_total": 545648, 
                    "inode_used": 123475, 
                    "mount": "/etc/resolv.conf", 
                    "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                    "size_available": 4861853696, 
                    "size_total": 8663535616, 
                    "uuid": "N/A"
                }, 
                "msg": "All assertions passed"
            }
            ok: [instance2] => (item={u'block_used': 928145, u'uuid': u'N/A', u'size_total': 8663535616, u'block_total': 2115121, u'mount': u'/etc/resolv.conf', u'block_available': 1186976, u'size_available': 4861853696, u'fstype': u'ext4', u'inode_total': 545648, u'inode_available': 422173, u'device': u'/dev/mapper/M--SA2--Ubuntu--vg-root', u'inode_used': 123475, u'block_size': 4096, u'options': u'rw,relatime,errors=remount-ro,data=ordered,bind'}) => {
                "ansible_loop_var": "item", 
                "changed": false, 
                "item": {
                    "block_available": 1186976, 
                    "block_size": 4096, 
                    "block_total": 2115121, 
                    "block_used": 928145, 
                    "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                    "fstype": "ext4", 
                    "inode_available": 422173, 
                    "inode_total": 545648, 
                    "inode_used": 123475, 
                    "mount": "/etc/resolv.conf", 
                    "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                    "size_available": 4861853696, 
                    "size_total": 8663535616, 
                    "uuid": "N/A"
                }, 
                "msg": "All assertions passed"
            }
            ok: [instance1] => (item={u'block_used': 928145, u'uuid': u'N/A', u'size_total': 8663535616, u'block_total': 2115121, u'mount': u'/etc/hosts', u'block_available': 1186976, u'size_available': 4861853696, u'fstype': u'ext4', u'inode_total': 545648, u'inode_available': 422173, u'device': u'/dev/mapper/M--SA2--Ubuntu--vg-root', u'inode_used': 123475, u'block_size': 4096, u'options': u'rw,relatime,errors=remount-ro,data=ordered,bind'}) => {
                "ansible_loop_var": "item", 
                "changed": false, 
                "item": {
                    "block_available": 1186976, 
                    "block_size": 4096, 
                    "block_total": 2115121, 
                    "block_used": 928145, 
                    "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                    "fstype": "ext4", 
                    "inode_available": 422173, 
                    "inode_total": 545648, 
                    "inode_used": 123475, 
                    "mount": "/etc/hosts", 
                    "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                    "size_available": 4861853696, 
                    "size_total": 8663535616, 
                    "uuid": "N/A"
                }, 
                "msg": "All assertions passed"
            }
    
            TASK [check : Available disk space] ********************************************
            ok: [instance2] => {
                    "msg": {
                    "changed": false, 
                    "msg": "All items completed", 
                    "results": [
                        {
                            "ansible_loop_var": "item", 
                            "changed": false, 
                            "failed": false, 
                            "item": {
                                "block_available": 1186976, 
                                "block_size": 4096, 
                                "block_total": 2115121, 
                                "block_used": 928145, 
                                "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                                "fstype": "ext4", 
                                "inode_available": 422173, 
                                "inode_total": 545648, 
                                "inode_used": 123475, 
                                "mount": "/etc/hosts", 
                                "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                                "size_available": 4861853696, 
                                "size_total": 8663535616, 
                                "uuid": "N/A"
                            }, 
                            "msg": "All assertions passed"
                        }, 
                        {
                            "ansible_loop_var": "item", 
                            "changed": false, 
                            "failed": false, 
                            "item": {
                                "block_available": 1186976, 
                                "block_size": 4096, 
                                "block_total": 2115121, 
                                "block_used": 928145, 
                                "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                                "fstype": "ext4", 
                                "inode_available": 422173, 
                                "inode_total": 545648, 
                                "inode_used": 123475, 
                                "mount": "/etc/hostname", 
                                "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                                "size_available": 4861853696, 
                                "size_total": 8663535616, 
                                "uuid": "N/A"
                            }, 
                            "msg": "All assertions passed"
                        }, 
                        {
                            "ansible_loop_var": "item", 
                            "changed": false, 
                            "failed": false, 
                            "item": {
                                "block_available": 1186976, 
                                "block_size": 4096, 
                                "block_total": 2115121, 
                                "block_used": 928145, 
                                "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                                "fstype": "ext4", 
                                "inode_available": 422173, 
                                "inode_total": 545648, 
                                "inode_used": 123475, 
                                "mount": "/etc/resolv.conf", 
                                "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                                "size_available": 4861853696, 
                                "size_total": 8663535616, 
                                "uuid": "N/A"
                            }, 
                            "msg": "All assertions passed"
                        }
                    ]
                }
            }
            ok: [instance1] => {
                "msg": {
                    "changed": false, 
                    "msg": "All items completed", 
                    "results": [
                        {
                            "ansible_loop_var": "item", 
                            "changed": false, 
                            "failed": false, 
                            "item": {
                                "block_available": 1186976, 
                                "block_size": 4096, 
                                "block_total": 2115121, 
                                "block_used": 928145, 
                                "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                                "fstype": "ext4", 
                                "inode_available": 422173, 
                                "inode_total": 545648, 
                                "inode_used": 123475, 
                                "mount": "/etc/hostname", 
                                "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                                "size_available": 4861853696, 
                                "size_total": 8663535616, 
                                "uuid": "N/A"
                            }, 
                            "msg": "All assertions passed"
                        }, 
                        {
                            "ansible_loop_var": "item", 
                            "changed": false, 
                            "failed": false, 
                            "item": {
                                "block_available": 1186976, 
                                "block_size": 4096, 
                                "block_total": 2115121, 
                                "block_used": 928145, 
                                "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                                "fstype": "ext4", 
                                "inode_available": 422173, 
                                "inode_total": 545648, 
                                "inode_used": 123475, 
                                "mount": "/etc/resolv.conf", 
                                "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                                "size_available": 4861853696, 
                                "size_total": 8663535616, 
                                "uuid": "N/A"
                            }, 
                            "msg": "All assertions passed"
                        }, 
                        {
                            "ansible_loop_var": "item", 
                            "changed": false, 
                            "failed": false, 
                            "item": {
                                "block_available": 1186976, 
                                "block_size": 4096, 
                                "block_total": 2115121, 
                                "block_used": 928145, 
                                "device": "/dev/mapper/M--SA2--Ubuntu--vg-root", 
                                "fstype": "ext4", 
                                "inode_available": 422173, 
                                "inode_total": 545648, 
                                "inode_used": 123475, 
                                "mount": "/etc/hosts", 
                                "options": "rw,relatime,errors=remount-ro,data=ordered,bind", 
                                "size_available": 4861853696, 
                                "size_total": 8663535616, 
                                "uuid": "N/A"
                            }, 
                            "msg": "All assertions passed"
                        }
                    ]
                }
            }
    
            TASK [check : Alarm not free disk space] ***************************************
        [DEPRECATION WARNING]: Using tests as filters is deprecated. Instead of using 
        `result|failed` use `result is failed`. This feature will be removed in version
        2.9. Deprecation warnings can be disabled by setting 
        deprecation_warnings=False in ansible.cfg.
            skipping: [instance2]
        [DEPRECATION WARNING]: Using tests as filters is deprecated. Instead of using 
        `result|failed` use `result is failed`. This feature will be removed in version
        2.9. Deprecation warnings can be disabled by setting 
        deprecation_warnings=False in ansible.cfg.
            skipping: [instance1]
    
            TASK [check : Chek for available memory] ***************************************
            ok: [instance2] => {
                "msg": "total RAM is 3855"
            }
            ok: [instance1] => {
                "msg": "total RAM is 3855"
            }
    
            TASK [check : alarm check memory free] *****************************************
            skipping: [instance2]
            skipping: [instance1]
    
            PLAY RECAP *********************************************************************
            instance1                  : ok=8    changed=0    unreachable=0    failed=0    skipped=4    rescued=0    ignored=1   
            instance2                  : ok=8    changed=0    unreachable=0    failed=0    skipped=4    rescued=0    ignored=1   
    
        --> Scenario: 'default'
        --> Action: 'idempotence'
        Idempotence completed successfully.
        --> Scenario: 'default'
        --> Action: 'side_effect'
        Skipping, side effect playbook not configured.
        --> Scenario: 'default'
        --> Action: 'verify'
        --> Executing Testinfra tests found in /home/kristoit/ansi/08/roles/check/molecule/default/tests/...
        --> Scenario: 'default'
        --> Action: 'cleanup'
        Skipping, cleanup playbook not configured.
        --> Scenario: 'default'
        --> Action: 'destroy'
    
            PLAY [Destroy] *****************************************************************
    
            TASK [Destroy molecule instance(s)] ********************************************
            changed: [localhost] => (item=instance1)
            changed: [localhost] => (item=instance2)
    
            TASK [Wait for instance(s) deletion to complete] *******************************
            changed: [localhost] => (item=None)
            FAILED - RETRYING: Wait for instance(s) deletion to complete (300 retries left).
            changed: [localhost] => (item=None)
            changed: [localhost]
    
            TASK [Delete docker network(s)] ************************************************
    
            PLAY RECAP *********************************************************************
            localhost                  : ok=2    changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0
    
        --> Pruning extra files from scenario ephemeral directory
        kristoit@M-SA2-Ubuntu:~/ansi/08/roles/check$ 
```
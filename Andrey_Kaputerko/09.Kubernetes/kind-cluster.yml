name: Build and Test with KinD
on:
  push:
    branches: [ main ]
jobs:
  setup-kind-cluster:
    name: Set up KinD Kubernetes Cluster
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Kubernetes KinD Cluster
        id: kind
        uses: helm/kind-action@v1
        with:
          registry: true
          registry_name: kind-cluster
          registry_port: 5001
          registry_enable_delete: true
      - name: Get cluster info
        run: kubectl cluster-info
      - name: Get Nodes
        run: kubectl get nodes
      - name: Get Kubectl version
        run: kubectl version